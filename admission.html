<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admission | PS Pethgam Wagoora</title>

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <style>
    :root{
      --primary:#1e3a8a;
      --secondary:#10b981;
      --text:#1f2937;
      --muted:#6b7280;
      --bg:#f3f4f6;
      --white:#fff;
      --border:#e5e7eb;
      --danger:#ef4444;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:"Segoe UI",system-ui,-apple-system,Arial,sans-serif;
      color:var(--text);
      background:#fff;
      line-height:1.35;
    }
    .container{max-width:1000px;margin:0 auto;padding:40px 20px}

    .admission-hero{
      background:
        linear-gradient(rgba(0,0,0,.62),rgba(0,0,0,.62)),
        url("https://images.unsplash.com/photo-1503676260728-1c00da094a0b?auto=format&fit=crop&q=80&w=1500");
      background-size:cover;
      background-position:center;
      color:#fff;
      text-align:center;
      padding:80px 20px;
    }
    .admission-hero h1{margin:0 0 6px}
    .admission-hero p{margin:0;opacity:.95;letter-spacing:.4px}

    .no-print{display:block}

    .steps{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
      gap:16px;
      margin:18px 0 34px;
      text-align:center;
    }
    .step-card{
      padding:16px;
      background:var(--bg);
      border:1px solid var(--border);
      border-radius:12px;
    }
    .step-num{
      background:var(--secondary);
      color:#fff;
      width:32px;height:32px;
      border-radius:50%;
      display:inline-flex;
      align-items:center;justify-content:center;
      font-weight:800;
      margin-bottom:10px;
    }

    .form-container{
      background:var(--white);
      border:1px solid var(--border);
      padding:24px;
      border-radius:14px;
      box-shadow:0 10px 25px rgba(0,0,0,.06);
    }

    .form-header{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:18px;
      margin-bottom:12px;
    }
    .form-title{margin:0;text-align:center;color:var(--primary);font-weight:900;letter-spacing:.2px}
    .form-subtitle{margin:8px 0 0;text-align:center;color:var(--muted)}
    .form-title-wrap{flex:1}

    /* Photo */
    .photo-upload{width:128px;min-width:128px}
    .photo-box{
      width:128px;height:150px;
      border:2px dashed #cbd5e1;
      border-radius:10px;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      background:#fff;
      cursor:pointer;
      overflow:hidden;
      user-select:none;
      transition:.2s;
    }
    .photo-box:hover{border-color:var(--secondary)}
    .photo-box:focus{outline:3px solid rgba(16,185,129,.25);outline-offset:2px}
    .photo-box img{width:100%;height:100%;object-fit:cover;display:none}
    .photo-box i{font-size:2rem;color:#94a3b8}
    .photo-box span{font-size:.72rem;color:#64748b;margin-top:6px;padding:0 8px;text-align:center}
    .photo-help{font-size:.78rem;color:var(--muted);margin-top:8px;text-align:center}

    .form-section-title{
      color:var(--primary);
      border-bottom:2px solid var(--bg);
      padding-bottom:10px;
      margin:24px 0 14px;
      font-size:1.02rem;
      font-weight:900;
      text-transform:uppercase;
      letter-spacing:.5px;
    }

    .form-row{display:flex;gap:16px;flex-wrap:wrap}
    .form-group{margin-bottom:14px}
    .form-row .form-group{flex:1;min-width:220px}
    label{display:block;font-weight:800;margin-bottom:6px;font-size:.92rem}
    .req{color:var(--danger)}

    input,select{
      width:100%;
      padding:12px;
      border:1px solid #cbd5e1;
      border-radius:10px;
      font-size:14px;
      background:#fff;
    }
    input:focus,select:focus{
      outline:3px solid rgba(30,58,138,.18);
      border-color:rgba(30,58,138,.55);
    }
    .hint{display:block;color:var(--muted);font-size:.78rem;margin-top:6px}

    .declaration{
      font-size:.9rem;
      color:var(--muted);
      border:1px solid var(--border);
      background:#fafafa;
      padding:14px;
      border-radius:10px;
      margin-top:14px;
    }

    .signatures{
      margin-top:52px;
      display:flex;
      justify-content:space-between;
      gap:16px;
      flex-wrap:wrap;
    }
    .sig-line{
      border-top:1px solid #111;
      width:240px;
      text-align:center;
      padding-top:6px;
      color:#111;
    }

    /* Submit button (always visible on mobile) */
    .actions{
      margin-top:16px;
    }
    .btn-submit{
      background:var(--primary);
      color:#fff;
      border:none;
      padding:15px 18px;
      border-radius:12px;
      cursor:pointer;
      font-size:1.05rem;
      width:100%;
      transition:.2s;
      font-weight:900;
      letter-spacing:.2px;
    }
    .btn-submit:hover{background:var(--secondary)}
    .btn-submit:disabled{opacity:.7;cursor:not-allowed}

    .sticky-submit{
      display:none;
      position:fixed;
      left:0;right:0;bottom:0;
      background:rgba(255,255,255,.92);
      border-top:1px solid var(--border);
      padding:12px 14px;
      z-index:9999;
      backdrop-filter: blur(6px);
    }
    .sticky-submit .btn-submit{max-width:1000px;margin:0 auto;display:block}

    footer{text-align:center;padding:40px 20px;color:var(--muted)}

    @media (max-width: 700px){
      .form-header{flex-direction:column;align-items:stretch}
      .photo-upload{width:100%;min-width:unset}
      .photo-box{margin:0 auto}
      .sticky-submit{display:block}
      .sig-line{width:100%;max-width:320px}
      .signatures{justify-content:center}
    }

    @media print{
      .no-print, .sticky-submit{display:none!important}
      body{-webkit-print-color-adjust:exact;print-color-adjust:exact}
      .container{padding:0}
      .form-container{box-shadow:none;border:none;padding:0}
    }
  </style>
</head>

<body>
  <header class="admission-hero">
    <h1>Admission Process 2026-27</h1>
    <p>GOVERNMENT PRIMARY SCHOOL PETHGAM WAGOORA</p>
  </header>

  <div class="container">
    <div class="no-print">
      <h2 style="text-align:center;color:var(--primary);margin-top:0;">Our 4-Step Admission Process</h2>
      <div class="steps">
        <div class="step-card"><span class="step-num">1</span><h3 style="margin:0 0 6px;">Online Form</h3><p style="margin:0;color:var(--muted);">Fill out all details.</p></div>
        <div class="step-card"><span class="step-num">2</span><h3 style="margin:0 0 6px;">Download PDF</h3><p style="margin:0;color:var(--muted);">Get pre-filled form.</p></div>
        <div class="step-card"><span class="step-num">3</span><h3 style="margin:0 0 6px;">Printout</h3><p style="margin:0;color:var(--muted);">Physical signing.</p></div>
        <div class="step-card"><span class="step-num">4</span><h3 style="margin:0 0 6px;">Submission</h3><p style="margin:0;color:var(--muted);">Submit at office.</p></div>
      </div>
    </div>

    <section class="form-container" id="printable-area">
      <div class="form-header">
        <div class="form-title-wrap">
          <h2 class="form-title">OFFICIAL REGISTRATION FORM</h2>
          <p class="form-subtitle">UDISE Code: <strong>01022202207</strong></p>
        </div>

        <div class="photo-upload">
          <label class="photo-box" id="photoBox" for="photoInput" tabindex="0" role="button" aria-label="Upload student photo">
            <i class="fas fa-user-plus" id="uploadIcon" aria-hidden="true"></i>
            <span id="uploadText">UPLOAD PHOTO</span>
            <img id="photoPreview" src="" alt="Student Photo" />
          </label>
          <input type="file" id="photoInput" name="photo" accept="image/*" style="display:none" />
          <div class="photo-help no-print">JPG/PNG â€¢ &lt; 2MB</div>
        </div>
      </div>

      <form id="admissionForm">
        <div class="form-section-title">1. Student Identity</div>

        <div class="form-group">
          <label for="studentName">Student's Name <span class="req">*</span></label>
          <input id="studentName" name="studentName" type="text" placeholder="Full Name" required />
        </div>

        <div class="form-group">
          <label for="aadhaarName">Name as per Aadhaar Card <span class="req">*</span></label>
          <input id="aadhaarName" name="aadhaarName" type="text" required />
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="aadhaarNumber">Aadhaar Number <span class="req">*</span></label>
            <input id="aadhaarNumber" name="aadhaarNumber" type="text" inputmode="numeric" pattern="^\\d{12}$" maxlength="12" placeholder="12 Digit Aadhaar" required />
            <small class="hint">Enter 12 digits (no spaces).</small>
          </div>
          <div class="form-group">
            <label for="dob">Date of Birth <span class="req">*</span></label>
            <input id="dob" name="dob" type="date" required />
          </div>
        </div>

        <div class="form-section-title">2. Family Details</div>

        <div class="form-row">
          <div class="form-group">
            <label for="fatherName">Father's Name <span class="req">*</span></label>
            <input id="fatherName" name="fatherName" type="text" required />
          </div>
          <div class="form-group">
            <label for="fatherContact">Father's Contact <span class="req">*</span></label>
            <input id="fatherContact" name="fatherContact" type="tel" inputmode="numeric" pattern="^\\d{10}$" maxlength="10" placeholder="10 Digit Mobile" required />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="motherName">Mother's Name <span class="req">*</span></label>
            <input id="motherName" name="motherName" type="text" required />
          </div>
          <div class="form-group">
            <label for="motherContact">Mother's Contact</label>
            <input id="motherContact" name="motherContact" type="tel" inputmode="numeric" pattern="^\\d{10}$" maxlength="10" placeholder="Optional" />
          </div>
        </div>

        <div class="form-section-title">3. Residence & Academic Info</div>

        <div class="form-group">
          <label for="residence">Residence (Village/Mohalla) <span class="req">*</span></label>
          <input id="residence" name="residence" type="text" required />
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="tehsil">Tehsil <span class="req">*</span></label>
            <input id="tehsil" name="tehsil" type="text" value="Wagoora" required />
          </div>
          <div class="form-group">
            <label for="district">District <span class="req">*</span></label>
            <input id="district" name="district" type="text" value="Baramulla" required />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="classSelected">Class Joining <span class="req">*</span></label>
            <select id="classSelected" name="classSelected" required>
              <option value="" selected disabled>Select Class</option>
              <option value="PP3">PP3</option>
              <option value="PP2">PP2</option>
              <option value="BALVATIKA">BALVATIKA</option>
              <option value="Class 1st">Class 1st</option>
              <option value="Class 2nd">Class 2nd</option>
              <option value="Class 3rd">Class 3rd</option>
              <option value="Class 4th">Class 4th</option>
              <option value="Class 5th">Class 5th</option>
            </select>
          </div>
          <div class="form-group">
            <label for="penNumber">PEN Number</label>
            <input id="penNumber" name="penNumber" type="text" placeholder="If available" />
          </div>
        </div>

        <div class="form-section-title">4. Banking & Category</div>

        <div class="form-row">
          <div class="form-group">
            <label for="bankAccount">Bank Account Number</label>
            <input id="bankAccount" name="bankAccount" type="text" inputmode="numeric" />
          </div>
          <div class="form-group">
            <label for="ifsc">IFSC Code</label>
            <input id="ifsc" name="ifsc" type="text" placeholder="JAKA0WAGORA" style="text-transform:uppercase" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="category">Category <span class="req">*</span></label>
            <select id="category" name="category" required>
              <option value="GENERAL">GENERAL</option>
              <option value="SC">SC</option>
              <option value="ST">ST</option>
              <option value="OBC">OBC</option>
            </select>
          </div>
          <div class="form-group">
            <label for="bloodGroup">Blood Group</label>
            <input id="bloodGroup" name="bloodGroup" type="text" placeholder="e.g., O+, A-" />
          </div>
        </div>

        <div class="declaration">
          <strong>Parents Declaration:</strong> I do hereby declare that the above information is true to the best of my knowledge and belief.
        </div>

        <div class="signatures">
          <p class="sig-line">Parent's Signature</p>
          <p class="sig-line">Headmaster Seal</p>
        </div>

        <!-- Normal submit button (desktop / inside form) -->
        <div class="actions no-print">
          <button type="submit" class="btn-submit" id="submitBtn">Submit & Download Pre-filled PDF Form</button>
        </div>
      </form>
    </section>
  </div>

  <!-- Sticky submit for mobile (always visible) -->
  <div class="sticky-submit no-print">
    <button class="btn-submit" id="stickySubmitBtn" type="button">Submit & Download Pre-filled PDF Form</button>
  </div>

  <footer class="no-print">
    <p style="margin:0;">Need help? Contact the School Office: <strong>+91-7006261694</strong></p>
  </footer>

  <script>
    (function(){
      const form = document.getElementById("admissionForm");
      const submitBtn = document.getElementById("submitBtn");
      const stickySubmitBtn = document.getElementById("stickySubmitBtn");

      const printableArea = document.getElementById("printable-area");

      const photoInput = document.getElementById("photoInput");
      const photoPreview = document.getElementById("photoPreview");
      const uploadIcon = document.getElementById("uploadIcon");
      const uploadText = document.getElementById("uploadText");

      //LocalStorage keys (so
photo/details "save")
const LS_KEY_FORM =
"pspw_admission_form_v1";
const LS_KEY_PHOTO = "pspw_admission_photo_v1";
// Digits-only helpers function digitsOnly(id){
const el =
document.getElementById(id);
if(!el) return;
el.addEventListener("input",
() => {
el.value = (el.value ||
"").replace(/\\D+/g, "");
saveFormToLocalStorage();
});
}
digitsOnly("aadhaarNumber");
digitsOnly("fatherContact");
digitsOnly("motherContact");
// Auto uppercase IFSC
const ifsc =
document.getElementById("ifsc");
if(ifsc){
  ifsc.addEventListener("input", =>
{
ifsc.value = (ifsc.value |
"").toUpperCase();
saveFormToLocalStorage(); });
}
// Save any input changes
form.querySelectorAll("input, select").forEach(el => {
if(el.type === "file")
return;
<script>
(function() {
    const form = document.getElementById('admissionForm');
    const photoPreview = document.getElementById('photoPreview');
    const submitBtn = document.querySelector('.btn-submit');
    const stickySubmitBtn = document.getElementById('stickySubmitBtn'); // Ensure this ID exists in your HTML

    // Utility to create the text block for the PDF
    function createValueBlock(val) {
        const span = document.createElement("span");
        span.style.display = "inline-block";
        span.style.padding = "8px 0";
        span.style.fontWeight = "bold";
        span.style.color = "#000";
        span.style.borderBottom = "1px solid #eee";
        span.style.width = "100%";
        span.innerText = val && val.trim() !== "" ? val : "__________";
        return span;
    }

    async function generatePdf() {
        // Trigger HTML5 validation
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }

        const studentName = document.getElementById('studentName').value || "Student";
        const safeStudentName = studentName.replace(/[^a-z0-9]/gi, '_').toLowerCase();
        
        const element = document.getElementById('printable-area');
        const clone = element.cloneNode(true);

        // Process inputs and selects
        const originals = element.querySelectorAll("input:not([type='file']), select");
        const clonedInputs = clone.querySelectorAll("input:not([type='file']), select");

        originals.forEach((orig, i) => {
            const target = clonedInputs[i];
            if (!target) return;
            
            let val = "";
            if (orig.tagName === "SELECT") {
                val = orig.options[orig.selectedIndex]?.text || "";
            } else {
                val = orig.value;
            }
            target.parentElement.replaceChild(createValueBlock(val), target);
        });

        // Fix Photo in Clone
        const cImg = clone.querySelector("#photoPreview");
        const cIcon = clone.querySelector("#uploadIcon");
        const cText = clone.querySelector("#uploadText");
        
        if (photoPreview.src && photoPreview.src.startsWith("data:image")) {
            cImg.src = photoPreview.src;
            cImg.style.display = "block";
            cIcon?.remove();
            cText?.remove();
        } else {
            cIcon?.remove();
            cText?.remove();
            cImg?.remove(); // Remove empty img tag to avoid "broken image" icon in PDF
        }

        // Remove UI elements from clone
        clone.querySelector("#photoInput")?.remove();
        clone.querySelectorAll(".no-print").forEach(el => el.remove());

        // Stage clone off-screen
        const staging = document.createElement("div");
        staging.style.position = "fixed";
        staging.style.left = "-10000px";
        staging.style.top = "0";
        staging.style.width = "800px"; // Standard A4 width context
        staging.style.background = "#ffffff";
        staging.appendChild(clone);
        document.body.appendChild(staging);

        const opt = {
            margin: 10,
            filename: `Admission_${safeStudentName}.pdf`,
            image: { type: "jpeg", quality: 0.98 },
            html2canvas: { 
                scale: 2, 
                useCORS: true, 
                allowTaint: true,
                backgroundColor: "#ffffff" 
            },
            jsPDF: { unit: "mm", format: "a4", orientation: "portrait" }
        };

        try {
            toggleButtons(true);
            await html2pdf().set(opt).from(clone).save();
            alert("Form Downloaded Successfully!");
        } catch (err) {
            console.error("PDF Error:", err);
            alert("PDF generation failed. Check console for details.");
        } finally {
            document.body.removeChild(staging);
            toggleButtons(false);
        }
    }

    function toggleButtons(disabled) {
        [submitBtn, stickySubmitBtn].forEach(btn => {
            if (!btn) return;
            btn.disabled = disabled;
            btn.textContent = disabled ? "Generating PDF..." : "Submit & Download Pre-filled PDF Form";
        });
    }

    form.addEventListener("submit", (e) => {
        e.preventDefault();
        generatePdf();
    });

    if (stickySubmitBtn) {
        stickySubmitBtn.addEventListener("click", (e) => {
            e.preventDefault();
            generatePdf();
        });
    }
})();
</script>
</body>
</html>
